Из результатов видно, что для получения эффекта виньетирования коэффиценты функции должны быть следущих знаков:
A < 0
B < 0
C -> 0
D > 0
E > 0
F -> 0

Test 1:
Difference = 0.025
Real data:
0.1 0.1 0.1 0.1
0.1 0.2 0.2 0.1
0.1 0.2 0.2 0.1
0.1 0.1 0.1 0.1

Predicted data:
0.0733 0.1247 0.1251 0.0745
0.1247 0.1759 0.1760 0.1252
0.1251 0.1760 0.1760 0.1250
0.0745 0.1252 0.1250 0.0737

Parameters:
A: -0.40790
B: -0.40790
C: -0.00346
D: 0.30745
E: 0.30745
F: 0.07335


Test 2:
Difference = 0.0541142
Real data:
0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1
0.1 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.1
0.1 0.2 0.2 0.3 0.3 0.3 0.3 0.2 0.2 0.1
0.1 0.2 0.2 0.4 0.4 0.4 0.4 0.2 0.2 0.1
0.1 0.2 0.2 0.4 0.5 0.5 0.5 0.2 0.2 0.1
0.1 0.2 0.2 0.4 0.5 0.5 0.5 0.2 0.2 0.1
0.1 0.2 0.2 0.4 0.4 0.4 0.4 0.2 0.2 0.1
0.1 0.2 0.2 0.3 0.3 0.3 0.3 0.2 0.2 0.1
0.1 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.1
0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1

Predicted data:
-0.0186 0.0601 0.1192 0.1588 0.1788 0.1792 0.1600 0.1213 0.0630 -0.0149
0.0543 0.1330 0.1921 0.2317 0.2516 0.2520 0.2329 0.1941 0.1358 0.0579
0.1090 0.1877 0.2468 0.2863 0.3063 0.3067 0.2875 0.2488 0.1904 0.1125
0.1455 0.2241 0.2832 0.3228 0.3427 0.3431 0.3239 0.2852 0.2268 0.1489
0.1637 0.2424 0.3015 0.3410 0.3610 0.3613 0.3421 0.3034 0.2450 0.1671
0.1638 0.2424 0.3015 0.3410 0.3610 0.3613 0.3421 0.3033 0.2450 0.1671
0.1456 0.2243 0.2833 0.3228 0.3428 0.3431 0.3239 0.2851 0.2267 0.1488
0.1092 0.1879 0.2469 0.2864 0.3064 0.3067 0.2875 0.2487 0.1903 0.1123
0.0546 0.1333 0.1923 0.2318 0.2517 0.2521 0.2328 0.1940 0.1356 0.0576
-0.0182 0.0605 0.1195 0.1590 0.1789 0.1792 0.1599 0.1211 0.0627 -0.0153

Parameters:
A: -0.91074
B: -0.97870
C: -0.00104
D: 0.82020
E: 0.88500
F: -0.01864


Test 3:
Difference = 0.0980691
Real data:
0.1 0.1 0.1 0.1
0.1 0.2 0.2 0.1
0.1 0.3 0.3 0.1
0.1 0.4 0.3 0.1
0.1 0.5 0.5 0.1
0.1 0.6 0.6 0.1
0.1 0.7 0.7 0.1
0.1 0.8 0.8 0.1
0.1 0.7 0.7 0.1
0.1 0.6 0.6 0.1
0.1 0.5 0.5 0.1
0.1 0.4 0.4 0.1
0.1 0.3 0.3 0.1
0.1 0.2 0.2 0.1
0.1 0.1 0.1 0.1

Predicted data:
-0.0898 0.2299 0.2277 -0.0963
-0.0078 0.3122 0.3102 -0.0137
0.0617 0.3818 0.3800 0.0564
0.1185 0.4388 0.4373 0.1138
0.1627 0.4832 0.4819 0.1586
0.1943 0.5150 0.5139 0.1908
0.2132 0.5342 0.5332 0.2104
0.2196 0.5407 0.5400 0.2173
0.2133 0.5347 0.5341 0.2117
0.1945 0.5160 0.5157 0.1934
0.1630 0.4847 0.4846 0.1625
0.1189 0.4408 0.4409 0.1190
0.0621 0.3843 0.3845 0.0629
-0.0072 0.3151 0.3156 -0.0058
-0.0892 0.2334 0.2341 -0.0872

Parameters:
A: -1.41932
B: -2.57517
C: 0.01212
D: 1.32539
E: 1.92273
F: -0.08982


Test 4:
Difference = 0.0618346
Real data:
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0
0 0.05 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.05 0
0 0.05 0.1 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.1 0.05 0
0 0.05 0.1 0.25 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.25 0.1 0.05 0
0 0.05 0.1 0.25 0.3 0.4 0.5 0.5 0.5 0.4 0.3 0.25 0.1 0.05 0
0 0.05 0.1 0.25 0.3 0.4 0.5 0.5 0.5 0.4 0.3 0.25 0.1 0.05 0
0 0.05 0.1 0.25 0.3 0.4 0.5 0.5 0.5 0.4 0.3 0.25 0.1 0.05 0
0 0.05 0.1 0.25 0.3 0.4 0.5 0.5 0.5 0.4 0.3 0.25 0.1 0.05 0
0 0.05 0.1 0.25 0.3 0.4 0.4 0.4 0.4 0.4 0.3 0.25 0.1 0.05 0
0 0.05 0.1 0.25 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.25 0.1 0.05 0
0 0.05 0.1 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.1 0.05 0
0 0.05 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.05 0
0 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

Predicted data:
-0.1829 -0.1121 -0.0523 -0.0033 0.0348 0.0620 0.0783 0.0838 0.0783 0.0620 0.0348 -0.0033 -0.0523 -0.1122 -0.1830
-0.1125 -0.0417 0.0181 0.0671 0.1052 0.1324 0.1487 0.1542 0.1487 0.1324 0.1052 0.0671 0.0181 -0.0418 -0.1126
-0.0529 0.0178 0.0777 0.1267 0.1648 0.1920 0.2083 0.2137 0.2083 0.1919 0.1647 0.1266 0.0776 0.0178 -0.0530
-0.0042 0.0665 0.1264 0.1754 0.2134 0.2407 0.2570 0.2624 0.2570 0.2406 0.2134 0.1753 0.1263 0.0665 -0.0043
0.0336 0.1043 0.1642 0.2132 0.2513 0.2785 0.2948 0.3003 0.2948 0.2785 0.2513 0.2132 0.1642 0.1043 0.0335
0.0606 0.1313 0.1912 0.2402 0.2783 0.3055 0.3218 0.3272 0.3218 0.3055 0.2783 0.2402 0.1912 0.1313 0.0605
0.0767 0.1475 0.2073 0.2563 0.2944 0.3216 0.3379 0.3434 0.3379 0.3216 0.2944 0.2563 0.2073 0.1474 0.0767
0.0820 0.1527 0.2126 0.2616 0.2997 0.3269 0.3432 0.3487 0.3432 0.3269 0.2997 0.2616 0.2126 0.1527 0.0820
0.0764 0.1472 0.2070 0.2560 0.2941 0.3213 0.3377 0.3431 0.3377 0.3213 0.2941 0.2560 0.2070 0.1472 0.0764
0.0600 0.1307 0.1906 0.2396 0.2777 0.3049 0.3212 0.3267 0.3212 0.3049 0.2777 0.2396 0.1906 0.1307 0.0600
0.0327 0.1035 0.1633 0.2123 0.2504 0.2776 0.2940 0.2994 0.2940 0.2776 0.2504 0.2123 0.1633 0.1035 0.0327
-0.0054 0.0653 0.1252 0.1742 0.2123 0.2395 0.2558 0.2613 0.2558 0.2395 0.2123 0.1742 0.1252 0.0654 -0.0054
-0.0544 0.0163 0.0762 0.1252 0.1633 0.1905 0.2068 0.2123 0.2068 0.1905 0.1633 0.1252 0.0762 0.0164 -0.0544
-0.1143 -0.0435 0.0164 0.0654 0.1035 0.1307 0.1470 0.1525 0.1470 0.1307 0.1035 0.0654 0.0164 -0.0435 -0.1142
-0.1850 -0.1142 -0.0543 -0.0053 0.0328 0.0600 0.0763 0.0818 0.0763 0.0600 0.0328 -0.0053 -0.0543 -0.1141 -0.1849

Parameters:
A: -1.22096
B: -1.22459
C: 0.00019
D: 1.13732
E: 1.14284
F: -0.18287


Test 5:
Difference = 0.0953837
Real data:
0.234 0.234 0.234 0.234 0.234 0.234 0.234 0.234 0.234 0.234
0.234 0.456 0.456 0.456 0.456 0.456 0.456 0.456 0.456 0.234
0.234 0.456 0.678 0.678 0.678 0.678 0.678 0.678 0.456 0.234
0.234 0.456 0.678 0.901 0.901 0.901 0.901 0.678 0.456 0.234
0.234 0.456 0.678 0.901 1 1 0.901 0.678 0.456 0.234
0.234 0.456 0.678 0.901 1 1 0.901 0.678 0.456 0.234
0.234 0.456 0.678 0.901 0.901 0.901 0.901 0.678 0.456 0.234
0.234 0.456 0.678 0.678 0.678 0.678 0.678 0.678 0.456 0.234
0.234 0.456 0.456 0.456 0.456 0.456 0.456 0.456 0.456 0.234
0.234 0.234 0.234 0.234 0.234 0.234 0.234 0.234 0.234 0.234

Predicted data:
-0.0176 0.1536 0.2820 0.3675 0.4101 0.4100 0.3669 0.2811 0.1523 -0.0192
0.1536 0.3249 0.4532 0.5388 0.5815 0.5813 0.5383 0.4525 0.3238 0.1523
0.2820 0.4532 0.5817 0.6672 0.7100 0.7099 0.6669 0.5811 0.4525 0.2810
0.3675 0.5388 0.6672 0.7529 0.7956 0.7956 0.7526 0.6669 0.5383 0.3668
0.4101 0.5815 0.7100 0.7956 0.8384 0.8384 0.7955 0.7098 0.5812 0.4098
0.4100 0.5813 0.7099 0.7956 0.8384 0.8384 0.7955 0.7098 0.5813 0.4099
0.3669 0.5383 0.6669 0.7526 0.7955 0.7955 0.7527 0.6671 0.5386 0.3672
0.2811 0.4525 0.5811 0.6669 0.7098 0.7098 0.6671 0.5814 0.4530 0.2817
0.1523 0.3238 0.4525 0.5383 0.5812 0.5813 0.5386 0.4530 0.3245 0.1533
-0.0192 0.1523 0.2810 0.3668 0.4098 0.4099 0.3672 0.2817 0.1533 -0.0180

Parameters:
A: -2.14226
B: -2.14226
C: 0.00356
D: 1.92621
E: 1.92621
F: -0.01757


Test 6:
Difference = 0.0630807
Real data:
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0
0 0.1 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.1 0
0 0.1 0.2 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.2 0.1 0
0 0.1 0.2 0.3 0.4 0.4 0.5 0.7 0.7 0.5 0.4 0.3 0.2 0.1 0
0 0.1 0.2 0.3 0.4 0.4 0.5 0.7 0.7 0.5 0.4 0.3 0.2 0.1 0
0 0.1 0.2 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.2 0.1 0
0 0.1 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.1 0
0 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

Predicted data:
-0.1650 -0.1024 -0.0494 -0.0060 0.0278 0.0521 0.0667 0.0718 0.0673 0.0532 0.0295 -0.0038 -0.0467 -0.0991 -0.1611
-0.0483 0.0142 0.0673 0.1107 0.1445 0.1688 0.1834 0.1885 0.1840 0.1699 0.1462 0.1129 0.0700 0.0176 -0.0445
0.0391 0.1017 0.1548 0.1982 0.2320 0.2563 0.2709 0.2760 0.2715 0.2574 0.2337 0.2004 0.1576 0.1051 0.0431
0.0975 0.1601 0.2131 0.2565 0.2903 0.3146 0.3293 0.3343 0.3298 0.3157 0.2920 0.2588 0.2159 0.1635 0.1014
0.1266 0.1892 0.2422 0.2857 0.3195 0.3438 0.3584 0.3635 0.3590 0.3449 0.3212 0.2879 0.2451 0.1926 0.1306
0.1266 0.1892 0.2422 0.2857 0.3195 0.3438 0.3584 0.3635 0.3590 0.3449 0.3212 0.2879 0.2451 0.1926 0.1306
0.0974 0.1600 0.2130 0.2565 0.2903 0.3146 0.3292 0.3343 0.3298 0.3157 0.2920 0.2588 0.2159 0.1635 0.1015
0.0391 0.1017 0.1547 0.1981 0.2320 0.2562 0.2709 0.2760 0.2715 0.2574 0.2337 0.2004 0.1576 0.1052 0.0431
-0.0485 0.0141 0.0672 0.1106 0.1444 0.1687 0.1834 0.1885 0.1840 0.1699 0.1462 0.1129 0.0701 0.0176 -0.0444
-0.1652 -0.1026 -0.0495 -0.0061 0.0277 0.0520 0.0667 0.0718 0.0673 0.0532 0.0295 -0.0037 -0.0466 -0.0990 -0.1611

Parameters:
A: -1.45857
B: -1.07856
C: 0.00031
D: 1.31253
E: 1.01080
F: -0.16502











